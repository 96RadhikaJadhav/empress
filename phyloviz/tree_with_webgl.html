<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-16">
  <title>WebGL - Experiment</title>
  <link rel="stylesheet" type="text/css" href="/static/style.css?v=a8f02de1862809b8f6a88ccc6d8e36af">
  <script type="text/javascript" src="/static/gl-matrix.js?v=7243103a666727ef3836be8b94bfccff"></script>
<script type="text/javascript" src="/static/jquery_min.js?v=a09e13ee94d51c524b7e2a728c7d4039"></script>
<script type="text/javascript" src="/static/init_webgl.js?v=5917eb5df7bfcc5699245e4cc7ae118c"></script>
<script type="text/javascript" src="/static/callbacks.js?v=1cec301b6805f98cf386a1b9e157a22d "></script>
<script type="text/javascript" src="/static/drawing_loop.js?v=3ecc4d9f3cc14af131a74ef80d5f7400 "></script>
<script type="text/javascript" src="/static/init_webpage.js?v=2c60189382fcbcfe9ddae0740746df8a "></script>
</head>

<body>
    <canvas class="tree-surface">
      Your browser does not support HTML5
    </canvas>
    <canvas class="text-surface"></canvas>

    <div class="metadata-tabs">

      <div class="tab-options">
        <div>
          <button class="tabs" onclick="showMenu(event,'highlight-menu')">Highlight Tips</button>
        </div>
      </div>

      <div class="menu" id="highlight-menu">
        <div>
          <select id = "highlight-options"></select>
        </div>

        <div>
          <input type = "button" value = "select" onclick = "userHighlightSelect();" />
          <input type = "color" id="color-selector"/>
        </div>

        <div class="text-field">
          <label for="lower-bound">Lower Bound</label>
          <input type="text" id="lower-bound"/>
        </div>

        <div class="text-field">
          <label for="upper-bound">Upper Bound</label>
          <input type="text" id="upper-bound"/>
        </div>

        <div class="text-field">
          <label for="category">Category Name</label>
          <input type="text" id="category"/>
        </div>

        <div class="attr-selector">
        </div>
      </div>
    </div>

    <div id="scrolltable">
      <table id="dataTable">
      </table>
    </div>

    <script  type="text/javascript">
      // global variables
      var urls = { // urls for webserver
        highlightURL : 'http://localhost:8080/highlight',
        collapseURL : 'http://localhost:8080/collapse',
        edgeURL : 'http://localhost:8080/api/edges',
        colorURL : 'http://localhost:8080/color',
        nodeURL : 'http://localhost:8080/api/nodes',
        tableURL : 'http://localhost:8080/table_values',
        labelURL : 'http://localhost:8080/label'
      };
      var field = {
        edgeFields : ["px", "py", "branch_color", "x", "y",
            "branch_color"],
        nodeFields : ["x", "y", "color"]
      };
      var shaderProgram = {}; // the complied vertex/fragment shaders
      var gl = {}; // webgl context - used to call webgl functions
      var drawingData = { // stores info need to draw such as vertex data
        isMouseDown : false,
        lastMouseX : null,
        lastMouseY : null,
        zoomAmount : 1,
        zoomLevel : 0,
        scaleFactor : 5.0 / 4.0
      };
      var numAttr = 0;
      var attrItem = {};

      var labels = {};
    </script>

    <script type="text/javascript">
    {
      let edgeMetadata;
      let nodeCoords;

      // this may cause some syncing issues
      $.getJSON(urls.nodeURL, function(data) {
        nodeCoords = data;
      }).done(function() {
        drawingData.nodeCoords = extractInfo(nodeCoords, field.nodeFields);

        $.getJSON(urls.edgeURL, function(data) {
          edgeMetadata = data;
        }).done(function() {
          initWebPage(edgeMetadata);
          drawingData.edgeCoords = extractInfo(edgeMetadata,field.edgeFields);
          drawingData.largeDim = normalizeTree(edgeMetadata);
          initWebGl();
          initCallbacks();
          setProjMat();
          draw();
        });
      });
    }
    </script>
    </body>
</html>
