<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WebGL - Experiment</title>
   <link rel="stylesheet" type="text/css" href="{{ static_url('vendor/css/slick.grid.css') }}">
   <link rel="stylesheet" type="text/css" href="{{ static_url('vendor/css/jquery-ui-1.11.3.custom.css') }}">
   <link rel="stylesheet" type="text/css" href="{{ static_url('vendor/css/slick.grid.format.css') }}">
   <link rel="stylesheet" type="text/css" href="{{ static_url('css/tree.css') }}">
   <link rel="stylesheet" type="text/css" href="{{ static_url('css/metadata.css') }}">
  <script type="text/javascript" src="{{ static_url('vendor/js/gl-matrix.min.js') }}"></script>
<script type="text/javascript" src="{{ static_url('vendor/js/jquery-2.2.4.min.js') }}"></script>
<script type="text/javascript" src="{{ static_url('vendor/js/jquery.event.drag-2.2.min.js') }}"></script>
<script type="text/javascript" src="{{ static_url('js/init_webgl.js') }}"></script>
<script type="text/javascript" src="{{ static_url('js/initialize_empress.js') }}"></script>
<script type="text/javascript" src="{{ static_url('js/mouse_events.js') }}"></script>
<script type="text/javascript" src="{{ static_url('js/callbacks.js') }}"></script>
<script type="text/javascript" src="{{ static_url('js/drawing_loop.js') }}"></script>
<script type="text/javascript" src="{{ static_url('js/init_webpage.js') }}"></script>
<script type="text/javascript" src="{{ static_url('vendor/js/slick.core.min.js') }}"></script>
<script type="text/javascript" src="{{ static_url('vendor/js/slick.editors.min.js') }}"></script>
<script type="text/javascript" src="{{ static_url('vendor/js/slick.formatters.min.js') }}"></script>
<script type="text/javascript" src="{{ static_url('vendor/js/slick.grid.min.js') }}"></script>
</head>

<body>
  <!-- The tree -->
  <div class="tree-container">
    <div class="container">
      <canvas class="tree-surface", id="tree-surface">
        Your browser does not support HTML5
      </canvas>
      <div id="divcontainer"></div>
      <div class="square"></div>
      <div class="selected-tree-menu">
        <input id="collapse" type = "button" value = "collapse" onclick="selectedTreeCollapse()"/>
      </div>
    </div>

    <div class="metadata-tabs">

      <!-- Branch tab -->
      <button class="collapsible">Branches</button>
      <div class="content">
        <div>
            <label for="highlight-options">Color by...</label>
            <select id = "highlight-options">
                <option value=0 disabled> -- select an option -- </option>
            </select>
          </div>
          <div>
            <label for="color-options">Choose Color Map</label>
            <select id = "color-options">
                <option disabled> -- Sequential -- </option>
                <option value="viridis" color="red">viridis</option>
                <option value="Blues">Blue</option>
                <option value="Greens">Green</option>
                <option value="Reds">Red</option>
                <option value="BuGn">Blue to Green</option>
                <option value="cool">Blue to Purple</option>
                <option value="YlOrRd">Yellow to Red</option>
                <option value="hot">Hot</option>
                <option value="winter">Winter</option>
                <option disabled>-- Diverging --</option>
                <option value="seismic">Blue to Red</option>
                <option value=coolwarm>Cool to Warm</option>
                <option value="PRGn">Purple to Green</option>
            </select>
          </div>
          <div>
            <button onclick="userHighlightSelect()">Color Branches</button>
          </div>
         <!--  <div class="gradient-bar">
            <div>0</div>
            <div class="gradient-color">
            </div>
            <div>50000</div>
          </div> -->
          <!-- <button></button> -->

          <!-- <div class="text-field">
            <label for="lower-bound">Lower Bound</label>
            <input type="text" id="lower-bound"/>
          </div>

          <div class="text-field">
            <label for="upper-bound">Upper Bound</label>
            <input type="text" id="upper-bound"/>
          </div>

          <div class="text-field">
            <label for="category">Equals to</label>
            <input type="text" id="category"/>
          </div>

          <div id="highlight-history">
          </div> -->
      </div>

      <!-- Color Clades -->
      <button class="collapsible">Color Clades</button>
      <div class="content">
        <div>
          <label for="tax-level">Taxonomic Level...</label>
          <select id = "tax-level">
            <option value=0 disabled> -- select an option -- </option>
            <option>Kindom</option>
            <option>Phylum</option>
            <option>Class</option>
            <option>Order</option>
            <option>Family</option>
            <option>Genus</option>
            <option>Species</option>
          </select>
        </div>
        <div>
            <label for="clade-options">Color by...</label>
            <select id = "clade-options">
                <option value=0 disabled> -- select an option -- </option>
                <option value=0>Default</option>
            </select>
          </div>
        <div>
          <label for="color-options-tax">Choose Color Map</label>
          <select id = "color-options-tax">
              <option disabled> -- Sequential -- </option>
              <option value="viridis" color="red">viridis</option>
              <option value="Blues">Blue</option>
              <option value="Greens">Green</option>
              <option value="Reds">Red</option>
              <option value="BuGn">Blue to Green</option>
              <option value="cool">Blue to Purple</option>
              <option value="YlOrRd">Yellow to Red</option>
              <option value="hot">Hot</option>
              <option value="winter">Winter</option>
              <option disabled>-- Diverging --</option>
              <option value="seismic">Blue to Red</option>
              <option value=coolwarm>Cool to Warm</option>
              <option value="PRGn">Purple to Green</option>
          </select>
        </div>
        <div id="taxonomic-color-div" >
          <label for="taxonomic-color-options">Taxonomic Color Map</label>
          <select id = "taxonomic-color-options">
              <option disabled> -- Sequential -- </option>
              <option value="viridis" color="red">viridis</option>
              <option value="Blues">Blue</option>
              <option value="Greens">Green</option>
              <option value="Reds">Red</option>
              <option value="BuGn">Blue to Green</option>
              <option value="cool">Blue to Purple</option>
              <option value="YlOrRd">Yellow to Red</option>
              <option value="hot">Hot</option>
              <option value="winter">Winter</option>
              <option disabled>-- Diverging --</option>
              <option value="seismic">Blue to Red</option>
              <option value=coolwarm>Cool to Warm</option>
              <option value="PRGn">Purple to Green</option>
          </select>
        </div>
        <div>
          <button onclick="userCladeColor()">Color Clades</button>
        </div>
      </div>
      <!-- Collapse -->
      <button class="collapsible">Auto-Collapse</button>
      <div class="content">
        <div>
          <label for="collapse-level">Collapse BY...</label>
          <select id = "collapse-level">
            <option value=0 disabled> -- select an option -- </option>
            <option>Kindom</option>
            <option>Phylum</option>
            <option>Class</option>
            <option>Order</option>
            <option>Family</option>
            <option>Genus</option>
            <option>Species</option>
          </select>
        </div>
        <div>
          <label for="color-options-tax">Choose Color Map</label>
          <select id = "color-options-collapse">
              <option disabled> -- Sequential -- </option>
              <option value="viridis" color="red">viridis</option>
              <option value="Blues">Blue</option>
              <option value="Greens">Green</option>
              <option value="Reds">Red</option>
              <option value="BuGn">Blue to Green</option>
              <option value="cool">Blue to Purple</option>
              <option value="YlOrRd">Yellow to Red</option>
              <option value="hot">Hot</option>
              <option value="winter">Winter</option>
              <option disabled>-- Diverging --</option>
              <option value="seismic">Blue to Red</option>
              <option value=coolwarm>Cool to Warm</option>
              <option value="PRGn">Purple to Green</option>
          </select>
        </div>
        <div>
          <label for="collapse-options">Color by...</label>
          <select id = "collapse-options">
              <option value=0 disabled> -- select an option -- </option>
          </select>
        </div>
        <div>
        <div>
          <button onclick="autoCollapseTree()">Collapse Tree</button>
        </div>
      </div>
    </div>
  </div>

  <script type="text/javascript">
    var coll = document.getElementsByClassName("collapsible");
    var i;

    for (i = 0; i < coll.length; i++) {
      coll[i].addEventListener("click", function() {
        this.classList.toggle("active");
        var content = this.nextElementSibling;
        if (content.style.display === "block") {
          content.style.display = "none";
          // this.style.opacity = 0.5;
        } else {
          content.style.display = "block";
          // this.style.opacity = 1;
        }
      });
    }
  </script>

  <div class="metadata-container">
    <button>Metadata</button>
    <div id="scrolltable">
      <!-- <table id="metadata-table">
        <tr>
          <td valign="top">
        </td>
        </tr>
      </table> -->
    </div>
  </div>


<div class="switch-button-container">
  <button id="switch-btn" onclick="switchContainers()">Metadata</button>
</div>

  <script type="text/javascript">
    // urls for webserver
    var urls = {
      autoCollapseURL: "http://" + window.location.host + "/auto_collapse_tree",
      newHighlightURL: "http://" + window.location.host + "/new_highlight",
      highlightURL: "http://" + window.location.host + "/highlight",
      collapseURL: "http://" + window.location.host + "/collapse",
      edgeURL: "http://" + window.location.host + "/api/edges",
      colorURL: "http://" + window.location.host + "/color",
      nodeURL: "http://"+ window.location.host + "/api/nodes",
      tableURL: "http://" + window.location.host + "/table_values",
      tableChangeURL: "http://" + window.location.host + "/table_change",
      headersURL: "http://" + window.location.host + "/headers",
      cladeURL: "http://" + window.location.host + "/clades",
      newCladeColor: "http://" + window.location.host + "/new_color_clade",
      cladeColorURL: "http://" + window.location.host + "/color_clade",
      clearColorCladeURL: "http://" + window.location.host + "/clear_clade",
      subTreeURL: "http://" + window.location.host + "/subtree",
      oldTreeURL: "http://" + window.location.host + "/oldtree",
      selectTreeURL: "http://" + window.location.host + "/select_nodes",
      collapseSTreeURL: "http://" + window.location.host + "/collapse_tree",
      trianglesURL: "http://" + window.location.host + "/api/triangles",
      autoCollapse: 'http://' + window.location.host + '/auto_collapse',
      uncollapseSTreeURL: "http://" + window.location.host + "/uncollapseSTree"

    };

    // fields to extract from metadata, used in extractInfo()
    let field = {
      edgeFields: ["px", "py", "branch_color", "x", "y",
          "branch_color"],
      nodeFields: ["x", "y", "color"],
      triangleFields: ["cx", "cy", "color", "lx", "ly", "color", "rx", "ry", "color"]
    };

    // stores matrices, and buffers that webgl will uses
    let shaderProgram = {};

    // the complied vertex/fragment shaders
    let gl = {}; // webgl context - used to call webgl functions

    // stores info need to draw such as vertex data
    let drawingData = {
      isMouseDown: false,
      lastMouseX: null,
      lastMouseY: null,
      zoomAmount: 10,
      currentZoom: 0,
      maxZoom: 30,
      coloredClades: [],
      selectTree: [],
      triangles: [],
      numBranches: 0
    };

    let numAttr = 0;
    let attrItem = {};
    let grid = {};
    let labels = {};
    let labelPos = 0;
    let gridInfo = {
      initData: [],
      data: [],
      columns: [],
      options: {},
      grid: {}
    };
    const TRI_PER_ARC = 100;
    const ELEMENTS_PER_VERT = 5;
    const VERT_PER_TRI = 3;


    let numUserSelects = 0;
    const CLEAR_COLOR_HEX = "FFFFFF";
    const CLEAR_COLOR = 1;
    let camera = {};
    let shftPress = false;
  </script>

  <script type="text/javascript">
  {
    initialize();
  }
  </script>

</body>
</html>
